---
layout: post
title: Dynamic Systems 101 Part 1 The Pendulum
date: 2025-08-28
description: this is what included plotly.js code could look like
tags: formatting charts
categories: sample-posts
chart:
  plotly: true
---


# Dynamic Systems 101: Part 1 â€” The Pendulum

In this series, when we talk about dynamical systems, we mainly mean finite-dimensional systems described by ordinary differential equations (ODEs). These are models where the state evolves in time but does not explicitly depend on space, such as the pendulum, the logistic map, or the Lorenz system.

While partial differential equations (PDEs) â€” like those in fluid dynamics â€” are also dynamical systems in a broader sense (infinite-dimensional ones), they belong to a different research community and require specialized mathematical and numerical tools. To keep this series focused and beginner-friendly, we will concentrate on ODE-based dynamical systems: their modeling, equilibrium points, stability, and basic numerical methods.

---

**æˆ‘ä»¬ä»å•æ‘†é—®é¢˜å…¥æ‰‹ï¼Œå¼€å§‹ä¸€æ­¥æ­¥çš„ç»“åˆ MosaicX å®Œæˆç®€å•åŠ¨åŠ›å­¦ç³»ç»Ÿçš„æ±‚è§£å·¥ä½œã€‚**

## 1. å•æ‘†çš„åŠ¨åŠ›å­¦æ–¹ç¨‹

å•æ‘†çš„åŸºæœ¬æ–¹ç¨‹æ˜¯ä¸€ä¸ªäºŒé˜¶éçº¿æ€§ ODEï¼š

$$
\ddot{\theta}(t) + \frac{g}{L}\sin\theta(t) = 0
$$

å…¶ä¸­ï¼š

- $\theta(t)$ï¼šæ‘†è§’
- $g$ï¼šé‡åŠ›åŠ é€Ÿåº¦
- $L$ï¼šæ‘†é•¿

å…¶ä¸­'äºŒé˜¶'é™¤äº†æŒ‡æœ€é«˜å«äºŒé˜¶å¯¼æ•°ä»¥å¤–ï¼Œè¿˜æ„å‘³ç€ï¼š1. è§£éœ€è¦ä¸¤ä¸ªåˆå§‹æ¡ä»¶ï¼›2.åœ¨æ•°å€¼åˆ†æé‡Œï¼Œè¦è½¬åŒ–ä¸ºä¸€é˜¶ç³»ç»Ÿæ±‚è§£

---
ä¸‹ä¸€æ­¥çš„é€»è¾‘ï¼Œç¡®å®å°±æ˜¯è¦è¿›å…¥ä¸¤ä¸ªå¸¸è§çš„â€œç­‰ä»·å½¢å¼â€ï¼š

1. **æ®‹å·®å½¢å¼ (Residual form)**
2. **ä¸€é˜¶ç³»ç»ŸåŒ– (First-order system)**

è¿™ä¸¤ä¸ªéƒ¨åˆ†åˆ†åˆ«è§£å†³ä¸åŒçš„éœ€æ±‚ï¼šä¸€ä¸ªæ˜¯ç”¨äºæ•°å€¼åˆ†æ/è§£çš„åˆ¤å®šï¼ˆæ®‹å·®å½¢å¼ï¼‰ï¼Œå¦ä¸€ä¸ªæ˜¯ç”¨äºç®—æ³•å®ç°ï¼ˆODE æ•°å€¼ç§¯åˆ†ï¼‰ã€‚

---

## 2. æ®‹å·®å½¢å¼ (Residual form)

æ®‹å·®å½¢å¼å°±æ˜¯æŠŠæ–¹ç¨‹å†™æˆâ€œå‡½æ•° = 0â€çš„å½¢å¼ï¼Œä¾¿äºç»Ÿä¸€å¤„ç†ã€‚

å¯¹äºå•æ‘†ï¼š

$$
R(\theta, \dot{\theta}, \ddot{\theta}) = \ddot{\theta} + \frac{g}{L}\sin\theta = 0
$$

* **å¥½å¤„**ï¼š

  * æ‰€æœ‰åŠ¨åŠ›å­¦æ–¹ç¨‹éƒ½å¯ä»¥æŠ½è±¡æˆ $F(x, \dot{x}, \ddot{x}, t)=0$ã€‚
  * åœ¨æ•°å€¼åˆ†æï¼ˆå¦‚ç‰›é¡¿è¿­ä»£ã€Jacobian æ„é€ ã€éšå¼æ–¹æ³•ï¼‰ä¸­ï¼Œç›´æ¥å¤„ç†â€œæ®‹å·®=0â€æ›´è‡ªç„¶ã€‚
  * æ¯”å¦‚ä½ è¦æ±‚ Jacobian æ—¶ï¼Œå°±å¯¹ $R$ å¯¹å„ä¸ªå˜é‡æ±‚åå¯¼ã€‚

* **è§£é‡Š**ï¼š

  * â€œæ®‹å·®â€ä¸ºé›¶ï¼Œè¯´æ˜å½“å‰è§£æ»¡è¶³æ–¹ç¨‹ï¼›
  * å¦‚æœæ®‹å·®ä¸ä¸ºé›¶ï¼Œè¯´æ˜è§£ä¸æ»¡è¶³åŠ¨åŠ›å­¦çº¦æŸï¼Œå¯ä»¥ç”¨äºè¿­ä»£ä¿®æ­£ã€‚

---

## 3. ä¸€é˜¶ç³»ç»ŸåŒ– (First-order system)

åœ¨æ•°å€¼ç§¯åˆ†ï¼ˆå¦‚ Rungeâ€“Kuttaï¼‰æ—¶ï¼ŒäºŒé˜¶æ–¹ç¨‹è¦æ‹†è§£ä¸ºä¸€é˜¶ç³»ç»Ÿï¼Œå› ä¸ºå¤§å¤šæ•° ODE æ±‚è§£å™¨åªæ¥å—ä¸€é˜¶å½¢å¼ï¼š

è®¾ï¼š

$$
x_1 = \theta, \quad x_2 = \dot{\theta}
$$

å¾—åˆ°ï¼š

$$
\begin{cases}
x_1' = x_2 \\
x_2' = -\dfrac{g}{L}\sin(x_1)
\end{cases}
$$

* **å¥½å¤„**ï¼š

  * å¯ä»¥ç›´æ¥ä¸¢ç»™ ODE solverï¼ˆå¦‚ Python çš„ `solve_ivp`ï¼‰ã€‚
  * ç¬¦åˆçŠ¶æ€ç©ºé—´å»ºæ¨¡æ€æƒ³ï¼š

    $$
    \dot{\mathbf{x}} = f(\mathbf{x},t)
    $$

* **ç‰©ç†æ„ä¹‰**ï¼š

  * $x_1$ï¼šè§’åº¦ï¼Œ$x_2$ï¼šè§’é€Ÿåº¦ï¼›
  * ç¬¬ä¸€æ¡æ–¹ç¨‹ï¼šè§’åº¦å˜åŒ–ç‡ç­‰äºè§’é€Ÿåº¦ï¼›
  * ç¬¬äºŒæ¡æ–¹ç¨‹ï¼šè§’é€Ÿåº¦å˜åŒ–ç‡ç­‰äºè§’åŠ é€Ÿåº¦ã€‚

---

## 4. æ®‹å·®å½¢å¼ vs ä¸€é˜¶ç³»ç»ŸåŒ–çš„ç”¨é€”

| å½¢å¼    | è¡¨è¾¾å¼                                      | ç”¨é€”                       |
| ----- | ---------------------------------------- | ------------------------ |
| æ®‹å·®å½¢å¼  | $R(\theta,\dot{\theta},\ddot{\theta})=0$ | ç¨³å®šæ€§åˆ†æã€æ„é€  Jacobianã€ä»£æ•°ç³»ç»Ÿæ±‚è§£ |
| ä¸€é˜¶ç³»ç»ŸåŒ– | $\mathbf{x}'=f(\mathbf{x},t)$            | å¸¸è§æ•°å€¼ç§¯åˆ†ã€çŠ¶æ€ç©ºé—´å»ºæ¨¡ã€æ§åˆ¶ç³»ç»Ÿ       |

---

ğŸ‘‰ ä½ æ¥ä¸‹æ¥çš„è®²è¿°å¯ä»¥è¿™æ ·é“ºæ’ï¼š

1. **åŸå§‹äºŒé˜¶éçº¿æ€§ ODE**ï¼ˆä½ å·²ç»å†™äº†ï¼‰
2. **æ®‹å·®å½¢å¼**ï¼ˆä¾¿äºç»Ÿä¸€å¤„ç†å’Œæ±‚ Jacobianï¼‰
3. **ä¸€é˜¶ç³»ç»ŸåŒ–**ï¼ˆè½¬ä¸ºæ•°å€¼ç§¯åˆ†å¯è§£çš„å½¢å¼ï¼‰

---

## ä¸€é˜¶ç³»ç»ŸåŒ– (First-order System Transformation)

### 1. åŸºæœ¬æ€è·¯

* é«˜é˜¶ ODE ä¸€èˆ¬ä¸æ–¹ä¾¿ç›´æ¥æ•°å€¼æ±‚è§£ã€‚
* æ‰€ä»¥æˆ‘ä»¬**å¼•å…¥æ–°çš„çŠ¶æ€å˜é‡**ï¼ŒæŠŠé«˜é˜¶å¯¼æ•°é€çº§â€œé™é˜¶â€ï¼Œç›´åˆ°å…¨éƒ¨å˜æˆä¸€é˜¶ã€‚
* ç›®æ ‡æ˜¯æŠŠæ–¹ç¨‹å†™æˆï¼š

  $$
  \dot{\mathbf{x}} = f(\mathbf{x}, t)
  $$

  å…¶ä¸­ $\mathbf{x}$ æ˜¯çŠ¶æ€å‘é‡ã€‚

---

### 2. å•æ‘†çš„ä¾‹å­

åŸå§‹æ–¹ç¨‹ï¼ˆäºŒé˜¶ï¼‰ï¼š

$$
\ddot{\theta}(t) + \frac{g}{L}\sin\theta(t) = 0
$$

**æ­¥éª¤ï¼š**

1. å®šä¹‰æ–°çš„å˜é‡ï¼š

   $$
   x_1 = \theta \quad (\text{è§’åº¦}), \quad x_2 = \dot{\theta} \quad (\text{è§’é€Ÿåº¦})
   $$

2. æ ¹æ®å®šä¹‰ï¼š

   $$
   x_1' = \dot{x}_1 = \dot{\theta} = x_2
   $$

3. åŸæ–¹ç¨‹æ”¹å†™ä¸ºï¼š

   $$
   x_2' = \ddot{\theta} = -\frac{g}{L}\sin(x_1)
   $$

**æœ€ç»ˆå¾—åˆ°çš„ä¸€é˜¶ç³»ç»Ÿï¼š**

$$
\begin{cases}
x_1' = x_2 \\
x_2' = -\dfrac{g}{L}\sin(x_1)
\end{cases}
$$

---

### 3. ä¸€é˜¶ç³»ç»Ÿçš„ä¼˜ç‚¹

* **ç»Ÿä¸€æ€§**ï¼šä¸ç®¡æ˜¯äºŒé˜¶ã€ä¸‰é˜¶ï¼Œç»Ÿç»Ÿè½¬æˆâ€œä¸€é˜¶ç³»ç»Ÿâ€åï¼ŒODE æ±‚è§£å™¨éƒ½èƒ½å¤„ç†ã€‚
* **çŠ¶æ€ç©ºé—´å½¢å¼**ï¼šå’Œæ§åˆ¶è®ºã€ä¿¡å·å¤„ç†ç­‰é¢†åŸŸçš„æ ‡å‡†å»ºæ¨¡æ–¹æ³•å®Œå…¨ä¸€è‡´ã€‚

  $$
  \dot{\mathbf{x}} = f(\mathbf{x},t), \quad \mathbf{x}(0)=\mathbf{x}_0
  $$
* **æ•°å€¼è®¡ç®—**ï¼š

  * Rungeâ€“Kutta (RK4) ç­‰æ–¹æ³•è¦æ±‚ä¸€é˜¶å½¢å¼ï¼›
  * Python `scipy.integrate.solve_ivp` ä¹Ÿæ˜¯è¦æ±‚ä½ ä¼ å…¥ $\dot{\mathbf{x}}=f(\mathbf{x},t)$ã€‚
* **æ‰©å±•æ€§**ï¼š

  * æ–¹ä¾¿åŠ ä¸Šé˜»å°¼ã€å¤–åŠ›ï¼š

    $$
    x_2' = -\frac{g}{L}\sin(x_1) - c x_2 + F(t)
    $$

---

### 4. ä¸€é˜¶ç³»ç»Ÿçš„ç‰©ç†è§£é‡Š

* **çŠ¶æ€å˜é‡**ï¼š

  * $x_1$ï¼šæ‘†çš„ä½ç½®ï¼ˆè§’åº¦ï¼‰ï¼›
  * $x_2$ï¼šæ‘†çš„é€Ÿåº¦ï¼ˆè§’é€Ÿåº¦ï¼‰ã€‚

* **æ¼”åŒ–è§„å¾‹**ï¼š

  * ç¬¬ä¸€æ¡æ–¹ç¨‹ï¼šè§’åº¦çš„å˜åŒ–ç‡å°±æ˜¯è§’é€Ÿåº¦ï¼›
  * ç¬¬äºŒæ¡æ–¹ç¨‹ï¼šè§’é€Ÿåº¦çš„å˜åŒ–ç‡ç”±é‡åŠ›æ¢å¤åŠ›å†³å®šã€‚

---

### 5. æ¨å¹¿

* ä»»æ„ $n$ é˜¶ ODEï¼š

  $$
  y^{(n)} = F(t,y,y',\dots,y^{(n-1)})
  $$

  éƒ½å¯ä»¥å¼•å…¥ $n$ ä¸ªçŠ¶æ€å˜é‡ï¼š

  $$
  x_1=y, \; x_2=y', \; \dots, \; x_n=y^{(n-1)}
  $$

  å¾—åˆ°ï¼š

  $$
  \dot{x}_1=x_2,\;\; \dot{x}_2=x_3,\;\; \dots,\;\; \dot{x}_n=F(t,x_1,\dots,x_n)
  $$

---

âœ… **æ€»ç»“**ï¼š
ä¸€é˜¶ç³»ç»ŸåŒ–å°±æ˜¯ä¸€ç§â€œé™é˜¶å±•å¼€â€çš„è¿‡ç¨‹ï¼š

* **æ•°å­¦ä¸Š**ï¼šæŠŠä»»æ„é«˜é˜¶ ODE åŒ–æˆä¸€é˜¶ç³»ç»Ÿï¼›
* **ç‰©ç†ä¸Š**ï¼šå¼•å…¥â€œçŠ¶æ€å˜é‡â€ï¼ŒæŠŠç³»ç»Ÿæè¿°ä¸ºâ€œçŠ¶æ€éšæ—¶é—´æ¼”åŒ–â€ï¼›
* **è®¡ç®—ä¸Š**ï¼šæ–¹ä¾¿ä½¿ç”¨æ ‡å‡† ODE ç§¯åˆ†å™¨ç›´æ¥æ•°å€¼æ±‚è§£ã€‚

---

è¦ä¸è¦æˆ‘å¸®ä½ å†™ä¸€ä¸ª **Python ä»£ç ç¤ºä¾‹**ï¼ˆç”¨ `solve_ivp` è§£å•æ‘†çš„ä¸€é˜¶ç³»ç»Ÿï¼‰ï¼Œè¿™æ ·ä½ èƒ½çœ‹åˆ°ä»ç†è®ºå…¬å¼åˆ°æ•°å€¼è§£çš„å®Œæ•´é—­ç¯ï¼Ÿ
